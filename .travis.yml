sudo: required

services:
  - docker

cache:
  directories:
  - $HOME/.m2

before_install:
  - sudo service mysql stop

script:
  - TAG=snapshot docker-compose up -d ackris-db ackris-web                 # start database(mysql) & web(wildfly) containers
  - sleep 10                                                               # allow db to start
  - mvn clean compile flyway:migrate                                       # deploy database schema
  - mvn clean verify -Dmaven.test.failure.ignore=false -Dtest.port=8070    # run E2E tests
